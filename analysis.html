<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nobility Chess Academy | Lessons</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Theme: Wine and Yellow */
        :root { --wine: #722f37; --yellow: #facc15; --gold: #fbbf24; --dark: #421010; --white: #ffffff; }
        body { font-family: 'Poppins', sans-serif; background: var(--wine); color: var(--white); margin: 0; padding-bottom: 50px; }
        
        .container { max-width: 900px; margin: 20px auto; padding: 25px; background: var(--white); color: #333; border-radius: 20px; border: 5px solid var(--yellow); box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        h1, h2 { font-family: 'Cinzel'; color: var(--wine); text-align: center; margin: 0 0 15px 0; }
        
        /* Nav Panels */
        .panel { background: #fefce8; padding: 15px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .btn { padding: 10px 18px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin: 5px; transition: 0.3s; font-family: 'Poppins'; }
        .btn-grade { background: var(--dark); color: var(--white); }
        .btn-lesson { background: #ddd; color: #333; }
        .active { background: var(--yellow) !important; color: #333 !important; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

        /* Board Styling */
        .lesson-flex { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; align-items: flex-start; }
        #board { width: 350px; border: 8px solid var(--wine); border-radius: 8px; }
        .instruction-box { flex: 1; min-width: 300px; background: #fffdf2; padding: 20px; border-radius: 12px; border-left: 8px solid var(--yellow); }

        /* Quiz UI */
        .quiz-card { display: none; background: #f9f9f9; padding: 25px; border-radius: 15px; border: 3px dashed var(--wine); margin-top: 20px; }
        .progress-bar { width: 100%; height: 10px; background: #ddd; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--yellow); width: 0%; transition: 0.5s; }
        .opt-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #ddd; border-radius: 10px; cursor: pointer; background: white; font-size: 1rem; text-align: left; }
        .correct { background: #fef9c3 !important; border-color: #facc15 !important; color: #854d0e; font-weight: bold; }
        .wrong { background: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b; }

        .submit-wa { display: none; width: 100%; background: var(--wine); color: white; padding: 20px; border: none; border-radius: 10px; font-weight: bold; font-size: 1.3rem; cursor: pointer; box-shadow: 0 4px 0 var(--dark); }
    </style>
</head>
<body>

<div class="container">
    <h1>Nobility Chess Academy</h1>

    <div class="panel">
        <div id="grade-nav">
            <button class="btn btn-grade active" onclick="setGrade(1, this)">Grade 1</button>
            <button class="btn btn-grade" onclick="setGrade(2, this)">Grade 2</button>
            <button class="btn btn-grade" onclick="setGrade(3, this)">Grade 3</button>
            <button class="btn btn-grade" onclick="setGrade(4, this)">Grade 4</button>
            <button class="btn btn-grade" onclick="setGrade(5, this)">Grade 5</button>
            <button class="btn btn-grade" onclick="setGrade(6, this)">Grade 6</button>
        </div>
        <div style="margin-top: 10px;" id="lesson-nav">
            <button class="btn btn-lesson active" onclick="setLesson(1, this)">Lesson 1</button>
            <button class="btn btn-lesson" onclick="setLesson(2, this)">Lesson 2</button>
            <button class="btn btn-lesson" onclick="setLesson(3, this)">Lesson 3</button>
            <button class="btn btn-lesson" onclick="setLesson(4, this)">Lesson 4</button>
            <button class="btn btn-lesson" onclick="setLesson(5, this)">Lesson 5</button>
        </div>
    </div>

    <div id="learning-ui" class="lesson-flex">
        <div id="board"></div>
        <div class="instruction-box">
            <h2 id="lesson-title">Loading...</h2>
            <p id="lesson-text"></p>
            <button class="btn" style="background:var(--wine); color:white; width:100%;" onclick="startQuiz()">Start 10-Question Assignment</button>
        </div>
    </div>

    <div id="quiz-ui" class="quiz-card">
        <div class="progress-bar"><div id="p-fill" class="progress-fill"></div></div>
        <h3 id="q-count">Question 1 of 10</h3>
        <p id="q-text" style="font-size: 1.2rem; font-weight: 600;"></p>
        <div id="options-box"></div>
        <div id="feedback" style="text-align:center; margin-top:15px; font-weight:bold;"></div>
        
        <button id="waBtn" class="submit-wa" onclick="submitToBusayo()">
            Submit to Mr. Busayo ðŸ“„
        </button>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>

<script>
    let currentGrade = 1;
    let currentLesson = 1;
    let currentQ = 0;
    let totalCorrect = 0;
    let board = null;

    const academyData = {
        "1-1": {
            title: "The King's Walk",
            pos: "4k3/8/8/8/8/8/8/4K3 w - - 0 1",
            text: "The King is the most important piece. He moves one square at a time.",
            questions: [
                { q: "How many squares can the King move?", a: "1", o: ["1", "2", "Unlimited"] },
                { q: "Can the King jump over other pieces?", a: "No", o: ["Yes", "No", "Only Pawns"] },
                { q: "Is the King the most important piece?", a: "Yes", o: ["Yes", "No", "Maybe"] },
                { q: "Can a King move to a square being attacked?", a: "No", o: ["Yes", "No", "Only if he's angry"] },
                { q: "How many Kings does each player start with?", a: "1", o: ["1", "2", "8"] },
                { q: "What shape is on top of the King's crown?", a: "A Cross", o: ["A Star", "A Cross", "A Circle"] },
                { q: "Can two Kings stand next to each other?", a: "No", o: ["Yes", "No", "Only in check"] },
                { q: "What happens if the King is checkmated?", a: "Game Ends", o: ["Game Ends", "Lose 5 points", "Nothing"] },
                { q: "Is the King the tallest piece?", a: "Yes", o: ["Yes", "No", "Sometimes"] },
                { q: "Which square does the White King start on?", a: "e1", o: ["d1", "e1", "f1"] }
            ]
        },
        "2-1": {
            title: "Piece Valuation",
            pos: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",
            text: "Learning the points helps you make winning trades.",
            questions: [
                { q: "How many points is a Rook worth?", a: "5", o: ["3", "5", "9"] },
                { q: "Which piece is worth 9 points?", a: "Queen", o: ["King", "Rook", "Queen"] },
                { q: "If you trade a Knight for a Bishop, is it an equal trade?", a: "Yes", o: ["Yes", "No", "Depends"] },
                { q: "How many points is a Pawn worth?", a: "1", o: ["1", "2", "3"] },
                { q: "Which piece is worth 3 points?", a: "Bishop", o: ["Rook", "Bishop", "Pawn"] },
                { q: "Losing a Queen for a Rook is a bad trade by how many points?", a: "4", o: ["2", "4", "5"] },
                { q: "How many points are two Rooks worth combined?", a: "10", o: ["5", "10", "15"] },
                { q: "Which piece has no point value because it can't be captured?", a: "King", o: ["Queen", "King", "Pawn"] },
                { q: "Which is more valuable: 3 Pawns or 1 Knight?", a: "They are equal", o: ["3 Pawns", "1 Knight", "They are equal"] },
                { q: "If you lose a Rook (5) but take a Queen (9), you are up...?", a: "4 points", o: ["2 points", "4 points", "9 points"] }
            ]
        },
        "3-1": {
            title: "Tactics: The Pin",
            pos: "4k3/4r3/8/8/8/8/4R3/4K3 w - - 0 1",
            text: "A pin is when a piece cannot move because it would expose a more valuable piece.",
            questions: [
                { q: "What is an 'Absolute Pin'?", a: "A pin against the King", o: ["A pin against the King", "A pin against a Rook", "A winning move"] },
                { q: "Which piece can NOT create a pin?", a: "Knight", o: ["Bishop", "Rook", "Knight"] },
                { q: "If a Bishop pins a Knight to the King, can the Knight move?", a: "No", o: ["Yes", "No", "Only to capture"] },
                { q: "A 'Relative Pin' is against which piece?", a: "Any piece except the King", o: ["The King", "Any piece except the King", "A Pawn"] },
                { q: "How do you break a pin?", a: "Move the valuable piece or block", o: ["Capture the King", "Move the valuable piece or block", "You can't"] },
                { q: "Which long-range piece is best at pinning on diagonals?", a: "Bishop", o: ["Rook", "Bishop", "Knight"] },
                { q: "Is a pin an offensive or defensive tactic?", a: "Offensive", o: ["Offensive", "Defensive", "Neither"] },
                { q: "If your piece is pinned, what should you do?", a: "Defend it or unpin it", o: ["Give it away", "Defend it or unpin it", "Resign"] },
                { q: "Can a Queen create a pin?", a: "Yes", o: ["Yes", "No", "Only on Rank 8"] },
                { q: "What is a 'Cross-Pin'?", a: "A piece pinned from two directions", o: ["A piece pinned from two directions", "A religious move", "A draw"] }
            ]
        },
        "4-1": {
            title: "Opening Principles",
            pos: "rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1",
            text: "The three main goals: Control center, Develop pieces, Safety.",
            questions: [
                { q: "Which squares make up the 'Center'?", a: "e4, d4, e5, d5", o: ["a1, h1, a8, h8", "e4, d4, e5, d5", "c3, f3, c6, f6"] },
                { q: "What is 'Development'?", a: "Moving pieces off the back rank", o: ["Moving pieces off the back rank", "Capturing pawns", "Castling"] },
                { q: "Should you move the same piece twice in the opening?", a: "No", o: ["Yes", "No", "Only the Queen"] },
                { q: "Why is 1.e4 a good opening move?", a: "Controls center and opens pieces", o: ["Controls center and opens pieces", "Attacks the King", "It's the only move"] },
                { q: "What is the main purpose of Castling?", a: "King safety", o: ["To attack", "King safety", "To move the Rook"] },
                { q: "Should you bring your Queen out too early?", a: "No", o: ["Yes", "No", "To scare the opponent"] },
                { q: "What piece should you usually develop first?", a: "Knight or Bishop", o: ["Rook", "Knight or Bishop", "King"] },
                { q: "What is a 'Gambit'?", a: "Sacrificing a pawn for development", o: ["A type of checkmate", "Sacrificing a pawn for development", "A illegal move"] },
                { q: "Which side of the board is usually safer to castle on?", a: "Kingside", o: ["Kingside", "Queenside", "Middle"] },
                { q: "What is 'Tempo' in the opening?", a: "A unit of time or a move", o: ["The speed of the clock", "A unit of time or a move", "A music term"] }
            ]
        },
        "5-1": {
            title: "Endgame Mastery",
            pos: "4k3/P7/8/8/8/8/8/4K3 w - - 0 1",
            text: "In the endgame, pawns are the stars and the King becomes a fighter.",
            questions: [
                { q: "What is a 'Passed Pawn'?", a: "A pawn with no pawns blocking it", o: ["A pawn that was captured", "A pawn with no pawns blocking it", "A pawn on e4"] },
                { q: "On which rank does a pawn promote?", a: "8th rank", o: ["1st rank", "7th rank", "8th rank"] },
                { q: "What is 'Opposition'?", a: "Kings facing each other with 1 square gap", o: ["Attacking the Queen", "Kings facing each other with 1 square gap", "Losing a piece"] },
                { q: "Can a King and 1 Bishop force a mate?", a: "No", o: ["Yes", "No", "Only on Sundays"] },
                { q: "What is 'Zugzwang'?", a: "Any move you make is bad", o: ["A fast attack", "Any move you make is bad", "Winning the game"] },
                { q: "Where should the King go in the endgame?", a: "The center", o: ["The corner", "The center", "The back rank"] },
                { q: "What is the 'Square Rule' used for?", a: "Seeing if a King can catch a pawn", o: ["Counting points", "Seeing if a King can catch a pawn", "Checking for mate"] },
                { q: "What is a 'Stalemate'?", a: "A draw where you have no moves", o: ["A win for White", "A draw where you have no moves", "A type of fork"] },
                { q: "Can a pawn promote to a King?", a: "No", o: ["Yes", "No", "Only in Level 5"] },
                { q: "What is the most powerful piece in the endgame?", a: "Queen", o: ["Pawn", "Queen", "King"] }
            ]
        },
        "6-1": {
            title: "Advanced Strategy",
            pos: "r1bqk2r/pp1n1ppp/2pbpn2/3p4/2PP4/2N1PN2/PPQ2PPP/R1B1KB1R w KQkq - 0 1",
            text: "Grandmasters look for weak squares and long-term plans.",
            questions: [
                { q: "What is an 'Outpost'?", a: "A square for a piece protected by a pawn", o: ["A captured square", "A square for a piece protected by a pawn", "The center"] },
                { q: "Which piece is best on an outpost?", a: "Knight", o: ["Rook", "Knight", "Pawn"] },
                { q: "What is a 'Hole' in a position?", a: "A square that can't be defended by pawns", o: ["A square that can't be defended by pawns", "A missing piece", "The edge"] },
                { q: "What is 'Prophylaxis'?", a: "Stopping the opponent's plan early", o: ["A type of attack", "Stopping the opponent's plan early", "Winning a Rook"] },
                { q: "What is a 'Minority Attack'?", a: "Attacking with fewer pawns to create a weakness", o: ["Attacking the King", "Attacking with fewer pawns to create a weakness", "A pawn trade"] },
                { q: "A 'Backward Pawn' is...?", a: "A pawn that cannot be guarded by another pawn", o: ["A pawn moving back", "A pawn that cannot be guarded by another pawn", "A winning pawn"] },
                { q: "Why are 'Doubled Pawns' usually bad?", a: "They cannot defend each other", o: ["They are too slow", "They cannot defend each other", "They block the King"] },
                { q: "What is the 'Exchange Sacrifice'?", a: "Giving up a Rook for a Knight/Bishop", o: ["Giving up a Rook for a Knight/Bishop", "Trading Queens", "Losing on purpose"] },
                { q: "What is 'Space' in chess?", a: "Having your pawns further advanced", o: ["The size of the board", "Having your pawns further advanced", "Having more pieces"] },
                { q: "What is a 'Candidate Move'?", a: "A move worth considering after looking at the board", o: ["A winning move", "A move worth considering after looking at the board", "An illegal move"] }
            ]
        }
    };

    function setGrade(g, btn) {
        currentGrade = g;
        $('.btn-grade').removeClass('active');
        $(btn).addClass('active');
        loadLesson();
    }

    function setLesson(l, btn) {
        currentLesson = l;
        $('.btn-lesson').removeClass('active');
        $(btn).addClass('active');
        loadLesson();
    }

    function loadLesson() {
        const key = `${currentGrade}-${currentLesson}`;
        const data = academyData[key] || { 
            title: "Coming Soon", pos: "start", 
            text: "This lesson is currently being prepared by Mr. Busayo.",
            questions: Array(10).fill({q: "Ready?", a: "Yes", o: ["Yes", "No", "Maybe"]})
        };

        $('#lesson-title').text(`Grade ${currentGrade}: ${data.title}`);
        $('#lesson-text').text(data.text);
        $('#learning-ui').show();
        $('#quiz-ui').hide();
        $('#waBtn').hide();

        if (board) board.destroy();
        board = Chessboard('board', {
            position: data.pos,
            showNotation: true,
            pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
        });
    }

    function startQuiz() {
        currentQ = 0;
        totalCorrect = 0;
        $('#learning-ui').hide();
        $('#quiz-ui').show();
        showQuestion();
    }

    function showQuestion() {
        const key = `${currentGrade}-${currentLesson}`;
        const data = academyData[key] || academyData["1-1"];
        const qData = data.questions[currentQ];
        
        $('#q-count').text(`Question ${currentQ + 1} of 10`);
        $('#p-fill').css('width', `${(currentQ / 10) * 100}%`);
        $('#q-text').text(qData.q);
        $('#feedback').text("");
        
        const shuffled = [...qData.o].sort(() => Math.random() - 0.5);
        $('#options-box').empty();
        
        shuffled.forEach(opt => {
            const b = $('<button class="opt-btn"></button>').text(opt);
            b.click(function() {
                $('.opt-btn').off('click');
                if (opt === qData.a) {
                    $(this).addClass('correct');
                    totalCorrect++;
                    $('#feedback').text("Excellent! âœ…");
                } else {
                    $(this).addClass('wrong');
                    $('#feedback').text("Not quite. âŒ Answer: " + qData.a);
                }
                
                setTimeout(() => {
                    currentQ++;
                    if (currentQ < 10) {
                        showQuestion();
                    } else {
                        finishQuiz();
                    }
                }, 1500);
            });
            $('#options-box').append(b);
        });
    }

    function finishQuiz() {
        $('#p-fill').css('width', '100%');
        $('#q-text').text("Workbook Complete!");
        $('#options-box').empty();
        $('#feedback').html(`<h2>Final Score: ${totalCorrect}/10</h2><p>Click below to log your score with Mr. Busayo.</p>`);
        $('#waBtn').show();
    }

    function submitToBusayo() {
        const googleFormUrl = "https://docs.google.com/forms/d/19VQAm3JueyiwpfDeh6kuf2rKa41lrssbsHiIlC-Pxe4/edit"; 
        window.open(googleFormUrl);
    }

    $(document).ready(loadLesson);
</script>

</body>
</html>
