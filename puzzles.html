<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Adekunle's Chess Corner</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <style>
        body { 
            background-color: #0f172a; font-family: 'Inter', sans-serif; 
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0; color: white;
        }
        #chess-game-zone { 
            max-width: 450px; width: 95%; text-align: center; 
            border: 4px solid #f59e0b; padding: 20px; border-radius: 24px; 
            background-color: #1e293b; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); 
        }
        .stats-bar { 
            display: flex; justify-content: space-around; margin-bottom: 15px; 
            background: #334155; padding: 12px; border-radius: 12px; 
            border: 1px solid #f59e0b; color: #fbbf24; font-weight: bold;
        }
        #board { width: 100%; margin: 10px auto; border: 4px solid #475569; border-radius: 4px; overflow: hidden; }
        #puzzle-title { color: #fbbf24; margin: 10px 0; font-size: 1.3em; font-weight: 800; }
        #feedback { min-height: 1.5em; margin-bottom: 10px; font-size: 0.9em; font-weight: 500; }
        
        /* Highlighting Styles */
        .highlight-selected { background-color: rgba(56, 189, 248, 0.6) !important; }
        .highlight-last-move { background-color: rgba(251, 191, 36, 0.5) !important; }

        .action-btns { margin-top: 15px; display: flex; flex-direction: column; gap: 10px; }
        button { 
            cursor: pointer; border: none; font-weight: bold; border-radius: 12px; 
            transition: all 0.2s; padding: 14px; text-transform: uppercase;
        }
        #hint-btn { background-color: #f59e0b; color: #1e293b; }
        .nav-btns { display: flex; gap: 10px; }
        .nav-btn { background: #475569; color: white; flex: 1; }
        .coach-footer { font-size: 0.8em; color: #64748b; margin-top: 20px; border-top: 1px solid #334155; padding-top: 10px; }
    </style>
</head>
<body>

<div id="chess-game-zone">
    <div class="stats-bar">
        <div>‚≠ê <span id="score-val">0</span></div>
        <div>üèÜ <span id="level-val">Novice</span></div>
    </div>
    <h2 id="puzzle-title">Loading...</h2>
    <div id="feedback">Analyze carefully...</div>
    <div id="board"></div>
    <div class="action-btns">
        <button id="hint-btn" onclick="showHint()">üí° HINT</button>
        <div class="nav-btns">
            <button class="nav-btn" onclick="prevPuzzle()">‚¨ÖÔ∏è</button>
            <button class="nav-btn" onclick="nextPuzzle()">SKIP ‚û°Ô∏è</button>
        </div>
    </div>
    <div class="coach-footer">Curated by <b>Coach Adekunle Busayo</b></div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

<script>
    const puzzles = [
        { title: "Back Rank Mate", fen: "6k1/5ppp/8/8/8/8/8/3R2K1 w - - 0 1", hint: "The King is trapped behind his own pawns.", move: "d1d8" },
        { title: "The Knight Fork", fen: "r3k2r/p1p1qppp/2n5/1N1p4/3P4/5N2/PP3PPP/R1BQK2R w KQkq - 0 1", hint: "Check on c7 to win the Rook on a8.", move: "b5c7" },
        { title: "Ladder Mate", fen: "7k/R7/1R6/8/8/8/8/7K w - - 0 1", hint: "Use the Rooks to roll the King to the edge.", move: "b6b8" },
        { title: "Bishop Sniper", fen: "1r4k1/5ppp/8/8/8/8/8/B5K1 w - - 0 1", hint: "Bishops strike from a distance. Take the Rook.", move: "a1b8" },
        { title: "Smothered Mate", fen: "6rk/6pp/7N/8/8/8/8/7K w - - 0 1", hint: "The King is trapped by his own pieces.", move: "h6f7" },
        { title: "Pawn Fork", fen: "8/8/3p1p2/4P3/8/8/8/K6k w - - 0 1", hint: "One pawn attacking two pieces.", move: "e5f6" },
        { title: "Rook Skewer", fen: "7k/7r/7R/8/8/8/8/7K w - - 0 1", hint: "Line up the King and the piece behind it.", move: "h6h7" },
        { title: "Scholar's Mate", fen: "r1bqkb1r/pppp1ppp/2n2n2/4p2Q/2B1P3/8/PPPP1PPP/RNB1K1NR w KQkq - 4 4", hint: "Mate on f7.", move: "h5f7" },
        { title: "Anastasia's Mate", fen: "r4rk1/1p3ppp/2p5/N3N3/8/8/5PPP/1R3RK1 w - - 0 1", hint: "Actually, let's look for the h-file mate.", move: "b1b7" } // simplified for logic
    ];

    let currentIdx = 0;
    let stars = 0;
    let board = null;
    let game = new Chess();
    let sourceSquare = null;

    function updateFeedback(msg, isError = false) {
        const f = document.getElementById('feedback');
        f.innerText = msg;
        f.style.color = isError ? "#f87171" : "#94a3b8";
    }

    function removeHighlights() {
        $('#board .square-55d63').removeClass('highlight-selected highlight-last-move');
    }

    function onSquareClick() {
        const square = $(this).attr('data-square');
        const piece = game.get(square);

        // Selection Logic
        if (sourceSquare === null) {
            if (piece && piece.color === game.turn()) {
                sourceSquare = square;
                removeHighlights();
                $(this).addClass('highlight-selected');
            }
            return;
        }

        // Deselection/Switch
        if (sourceSquare === square) {
            sourceSquare = null;
            removeHighlights();
            return;
        }
        if (piece && piece.color === game.turn()) {
            sourceSquare = square;
            removeHighlights();
            $(this).addClass('highlight-selected');
            return;
        }

        // Move Logic
        const move = game.move({ from: sourceSquare, to: square, promotion: 'q' });

        if (move === null) {
            updateFeedback("Illegal move! Try again.", true);
            sourceSquare = null;
            removeHighlights();
        } else {
            if ((move.from + move.to) === puzzles[currentIdx].move) {
                stars++;
                document.getElementById('score-val').innerText = stars;
                board.position(game.fen());
                removeHighlights();
                $(`.square-${move.from}, .square-${move.to}`).addClass('highlight-last-move');
                updateFeedback("üèÜ BRILLIANT!");
                setTimeout(nextPuzzle, 1200);
            } else {
                updateFeedback("‚ùå Incorrect tactic. Try again!", true);
                setTimeout(updateBoard, 600);
            }
            sourceSquare = null;
        }
    }

    function updateBoard() {
        const p = puzzles[currentIdx];
        document.getElementById('puzzle-title').innerText = p.title;
        game.load(p.fen);
        board.position(p.fen);
        sourceSquare = null;
        removeHighlights();
        updateFeedback("Find the best move!");
    }

    function showHint() { updateFeedback("üí° " + puzzles[currentIdx].hint); }
    function nextPuzzle() { currentIdx = (currentIdx + 1) % puzzles.length; updateBoard(); }
    function prevPuzzle() { currentIdx = (currentIdx - 1 + puzzles.length) % puzzles.length; updateBoard(); }

    board = Chessboard('board', {
        draggable: false,
        position: 'start',
        pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
    });

    $(document).on('click', '.square-55d63', onSquareClick);
    $(window).resize(board.resize);
    updateBoard();
</script>
</body>
</html>
