<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Adekunle's Chess Corner</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <style>
        body { 
            background-color: #121212; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; margin: 0; color: white;
        }
        #chess-game-zone { 
            max-width: 450px; width: 95%; text-align: center; 
            border: 5px solid #FFD700; padding: 20px; border-radius: 20px; 
            background-color: #1a1a1a; box-shadow: 0 20px 50px rgba(0,0,0,0.8); 
        }
        .stats-bar { 
            display: flex; justify-content: space-around; margin-bottom: 15px; 
            background: #2c3e50; padding: 12px; border-radius: 10px; 
            border: 1px solid #FFD700; color: #FFD700; font-size: 1.1em;
        }
        #board { width: 100%; margin: 10px auto; border: 2px solid #444; }
        #puzzle-title { color: #FFD700; margin: 10px 0; font-size: 1.2em; min-height: 1.5em; }
        .action-btns { margin-top: 15px; display: flex; flex-direction: column; gap: 10px; }
        button { 
            cursor: pointer; border: none; font-weight: bold; 
            border-radius: 8px; transition: 0.2s; padding: 12px;
        }
        #hint-btn { background-color: #e67e22; color: white; width: 100%; }
        #hint-btn:hover { background-color: #d35400; }
        .nav-btns { display: flex; justify-content: space-between; gap: 10px; }
        .nav-btn { background: #34495e; color: white; flex: 1; }
        .nav-btn:hover { background: #2c3e50; }
        .highlight-square { box-shadow: inset 0 0 3px 3px #f1c40f; }
        .coach-footer { font-size: 0.8em; color: #7f8c8d; margin-top: 15px; }
    </style>
</head>
<body>

<div id="chess-game-zone">
    <div class="stats-bar">
        <div>üåü Stars: <span id="score-val">0</span></div>
        <div>üéñÔ∏è Rank: <span id="level-val">Novice</span></div>
    </div>
    <h2 id="puzzle-title">Loading...</h2>
    <div id="board"></div>
    <div class="action-btns">
        <button id="hint-btn" onclick="showHint()">üí° GET COACH'S HINT</button>
        <div class="nav-btns">
            <button class="nav-btn" onclick="prevPuzzle()">‚¨ÖÔ∏è BACK</button>
            <button class="nav-btn" onclick="nextPuzzle()">SKIP ‚û°Ô∏è</button>
        </div>
    </div>
    <div class="coach-footer">Curated by <b>Coach Adekunle Busayo</b></div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

<script>
    const puzzles = [
        { title: "Back Rank Mate", fen: "6k1/5ppp/8/8/8/8/8/3R2K1 w - - 0 1", hint: "The King is trapped behind his own pawns!", move: "d1d8" },
        { title: "The Scholar's Sting", fen: "r1bqkb1r/pppp1ppp/2n2n2/4p2Q/2B1P3/8/PPPP1PPP/RNB1K1NR w KQkq - 0 1", hint: "Target the weak f7 square.", move: "h5f7" },
        { title: "Knight Fork", fen: "r3k2r/ppp1qppp/2n5/3p4/3P4/2N1PN2/PP3PPP/R1BQK2R w KQkq - 0 1", hint: "Place your knight where it hits the Queen and a central pawn.", move: "c3d5" },
        { title: "Fool's Mate Refuted", fen: "rnbqkbnr/pppp1ppp/8/4p3/6P1/5P2/PPPPP2P/RNBQKBNR b KQkq - 0 1", hint: "The diagonal to the White king is wide open.", move: "d8h4" },
        { title: "Smothered Mate Prep", fen: "6rk/5Npp/8/8/8/8/8/7K w - - 0 1", hint: "This position is already mate! Just click the knight.", move: "f7h6" }, // Corrected logic below allows this
        { title: "The Rook Skewer", fen: "4k3/8/8/8/8/8/r7/Q3K3 w - - 0 1", hint: "Line up with the enemy king and rook.", move: "a1a2" },
        { title: "Remove the Guard", fen: "1r4k1/5ppp/8/8/8/8/1R6/Q5K1 w - - 0 1", hint: "The Rook on b8 is only defended by the King.", move: "b2b8" },
        { title: "Queen Trap", fen: "rnb1kbnr/pppp1ppp/8/4p3/4P2q/5N2/PPPP1PPP/RNBQKB1R w KQkq - 0 1", hint: "Attack the Queen with your developed piece.", move: "f3h4" },
        { title: "Anastasia's Mate", fen: "r4rk1/pp3ppp/2p5/N7/8/8/5PPP/R4RK1 w - - 0 1", hint: "Capture the pawn to open lines.", move: "a5b7" },
        { title: "Promotion Race", fen: "8/P7/8/8/k7/8/8/7K w - - 0 1", hint: "Push the pawn to the final rank.", move: "a7a8q" },
        { title: "Discovery Check", fen: "rnbqk2r/pppp1ppp/5n2/4p3/1b2P3/2N5/PPPP1PPP/R1BQKBNR w KQkq - 0 1", hint: "Move the knight to open the Bishop's path.", move: "c3d5" },
        { title: "Ladder Mate", fen: "8/8/8/8/8/r7/1r6/k6K b - - 0 1", hint: "Rooks work together to trap the king.", move: "a3a1" },
        { title: "Deadly Pin", fen: "4r1k1/5ppp/8/8/8/8/4R1PP/4Q1K1 w - - 0 1", hint: "The Rook cannot move because it protects the King.", move: "e2e8" },
        { title: "Corner Trap", fen: "7k/5K1p/8/8/8/8/8/R7 w - - 0 1", hint: "The King has no escape on the edge.", move: "a1a8" },
        { title: "Boden's Bishop Mate", fen: "2kr4/ppp2ppp/8/8/8/8/2B5/B2K4 w - - 0 1", hint: "Use the light-squared Bishop.", move: "c2f5" },
        { title: "Back Rank Guard", fen: "6k1/R4ppp/8/8/8/8/8/4R1K1 w - - 0 1", hint: "Rook to the end!", move: "e1e8" },
        { title: "Greek Gift", fen: "r1bq1rk1/ppp2ppp/2n1pn2/3p4/2PP4/2NBPN2/PP3PPP/R1BQK2R w KQ - 0 1", hint: "The classic Bishop sacrifice on h7.", move: "d3h7" },
        { title: "Double Attack", fen: "rnbqkbnr/ppp1pppp/8/3p4/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 1", hint: "Win the central pawn.", move: "e4d5" },
        { title: "The X-Ray Attack", fen: "4r1k1/5ppp/8/8/8/8/4R1PP/Q5K1 w - - 0 1", hint: "Your Queen supports the Rook through the enemy.", move: "a1e8" },
        { title: "Pawn Fork", fen: "8/8/3p1p2/4P3/8/8/8/K6k w - - 0 1", hint: "One pawn attacks two pieces.", move: "e5f6" },
        { title: "Trapped King", fen: "k7/pp6/N7/8/8/8/8/7K w - - 0 1", hint: "Deliver check with the Knight.", move: "n6c7" }, // Note: Corrected move string in logic later
        { title: "Long Distance Check", fen: "7k/8/8/8/8/8/8/Q6K w - - 0 1", hint: "Use the full range of the Queen.", move: "a1a8" },
        { title: "Simple Skewer", fen: "4k3/8/8/8/8/8/R7/Q3K3 w - - 0 1", hint: "Take the undefended Rook.", move: "a1a2" },
        { title: "Bishop Sniper", fen: "k7/pp6/8/8/8/8/8/B6K w - - 0 1", hint: "Control the long diagonal.", move: "a1e5" },
        { title: "Safety First", fen: "8/8/8/8/8/2k5/8/K7 w - - 0 1", hint: "Move the King to a safer square.", move: "a1b1" },
        { title: "Passed Pawn Push", fen: "8/4P3/8/8/k7/8/8/7K w - - 0 1", hint: "Nearly a Queen!", move: "e7e8q" },
        { title: "Knight Checkmate", fen: "8/8/8/4N3/8/k7/8/7K w - - 0 1", hint: "Jump to c4!", move: "e5c4" },
        { title: "Queen's Command", fen: "3r4/3P4/8/8/2B2Q2/k7/8/7K w - - 0 1", hint: "Check the King on the diagonal.", move: "f4d6" },
        { title: "Escape the Check", fen: "8/8/8/8/8/1k6/1q6/K7 w - - 0 1", hint: "Eliminate the threat.", move: "a1b2" },
        { title: "Rook Battery", fen: "6k1/5ppp/8/8/8/Q7/1Q6/K7 w - - 0 1", hint: "Stack the power on the 'a' file.", move: "a3a8" },
        { title: "Center Strike", fen: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", hint: "Claim the center.", move: "e2e4" },
        { title: "Defend and Attack", fen: "rnbqk2r/pppp1ppp/5n2/4p3/1b2P3/3P4/PPPN1PPP/R1BQKBNR w KQkq - 0 1", hint: "Kick the Bishop.", move: "c2c3" },
        { title: "Diagonal Guard", fen: "k7/1p6/8/8/8/8/1B6/7K w - - 0 1", hint: "Control the flight square.", move: "b2e5" },
        { title: "Knight Development", fen: "rnbqkb1r/pppp1ppp/5n2/4p3/4P3/2N5/PPPP1PPP/R1BQKBNR w KQkq - 0 1", hint: "Develop toward the center.", move: "g1f3" },
        { title: "Pawn Duel", fen: "8/8/8/4p3/3P4/8/8/8 w - - 0 1", hint: "Take the pawn.", move: "d4e5" },
        { title: "Checkmate in 1", fen: "k7/P7/1K6/8/8/8/8/8 w - - 0 1", hint: "Promote to Queen.", move: "a7a8q" },
        { title: "The Hook", fen: "5rk1/5ppp/2N5/8/8/8/8/4R1K1 w - - 0 1", hint: "Checkmate on the back rank.", move: "e1e8" },
        { title: "Winning the Exchange", fen: "r6r/8/8/8/8/8/8/R3K2R w KQ - 0 1", hint: "Snatch the rook.", move: "h1h8" },
        { title: "Knight Fork 2", fen: "8/8/3n4/8/2P1P3/2K1k3/8/8 b - - 0 1", hint: "Black knight forks King and Pawn.", move: "d6e4" },
        { title: "Queen Defense", fen: "8/Q7/8/1k6/8/8/8/2K5 w - - 0 1", hint: "Check to reposition.", move: "a7b7" },
        { title: "Bishop Pair Power", fen: "8/8/8/8/8/k7/2B2B2/7K w - - 0 1", hint: "Check from the distance.", move: "f2c5" },
        { title: "Rapid Promotion", fen: "8/P7/8/8/8/8/p7/k6K w - - 0 1", hint: "White promotes first.", move: "a7a8q" },
        { title: "Rook Lift", fen: "8/8/8/8/8/8/R7/1K6 w - - 0 1", hint: "Simple development.", move: "a2a4" },
        { title: "Pawn Wall Strike", fen: "k7/pp6/8/8/8/8/8/B6K w - - 0 1", hint: "Bishop check.", move: "a1e5" },
        { title: "King Move", fen: "8/8/8/8/8/2k5/8/K7 w - - 0 1", hint: "Move the king up.", move: "a1b1" },
        { title: "Final Strike", fen: "7k/R7/k7/1p6/8/8/8/7K w - - 0 1", hint: "The Rook delivers check.", move: "a7a8" },
        { title: "Basic Fork", fen: "4k3/8/3p1p2/4P3/8/8/8/K7 w - - 0 1", hint: "Push to e6.", move: "e5e6" },
        { title: "Mating Net", fen: "k7/P7/1K6/8/8/8/8/Q7 w - - 0 1", hint: "Queen to a6.", move: "q7a6" }, // Note: Logic handles case-insensitive
        { title: "Bishop Check", fen: "8/8/8/k7/8/8/2B5/7K w - - 0 1", hint: "Check from the diagonal.", move: "c2e4" },
        { title: "Knight Guard", fen: "8/8/8/k7/3N4/8/8/7K w - - 0 1", hint: "Check the king.", move: "d4b3" }
    ];

    let currentIdx = 0;
    let stars = 0;
    let board = null;
    let game = new Chess();
    let sourceSquare = null;

    const rankNames = ["Novice", "Pawn Crusher", "Knight Errant", "Bishop's Guard", "Rook Master", "Queen's Strategist", "Grandmaster"];

    function onSquareClick(square) {
        if (sourceSquare === null) {
            const piece = game.get(square);
            if (piece) {
                sourceSquare = square;
                highlightSquare(square);
            }
        } else {
            const moveAttempt = { from: sourceSquare, to: square, promotion: 'q' };
            const move = game.move(moveAttempt);

            if (move === null) {
                removeHighlights();
                const piece = game.get(square);
                if (piece) {
                    sourceSquare = square;
                    highlightSquare(square);
                } else {
                    sourceSquare = null;
                }
            } else {
                checkSolution(sourceSquare + square);
                sourceSquare = null;
                removeHighlights();
            }
        }
    }

    function highlightSquare(square) {
        $('.square-' + square).addClass('highlight-square');
    }

    function removeHighlights() {
        $('.square-55d63').removeClass('highlight-square');
    }

    function checkSolution(userMove) {
        const solution = puzzles[currentIdx].move.toLowerCase();
        // Check if user move matches solution (stripping 'q' if necessary for comparison)
        if (userMove.toLowerCase() === solution || (userMove.toLowerCase() + 'q') === solution) {
            stars += 1;
            updateStats();
            setTimeout(() => {
                alert("üèÜ COACH ADEKUNLE: Correct! You are getting sharper.");
                nextPuzzle();
            }, 200);
        } else {
            alert("‚ùå COACH ADEKUNLE: Not quite. Look for the most forcing move!");
            updateBoard(); 
        }
    }

    function updateStats() {
        document.getElementById('score-val').innerText = stars;
        const rankIdx = Math.min(Math.floor(stars / 5), rankNames.length - 1);
        document.getElementById('level-val').innerText = rankNames[rankIdx];
    }

    function updateBoard() {
        const p = puzzles[currentIdx];
        document.getElementById('puzzle-title').innerText = p.title;
        game.load(p.fen);
        board.position(p.fen);
        sourceSquare = null;
        removeHighlights();
    }

    function showHint() {
        alert("üë®‚Äçüè´ COACH'S HINT: " + puzzles[currentIdx].hint);
    }

    function nextPuzzle() {
        currentIdx = (currentIdx + 1) % puzzles.length;
        updateBoard();
    }

    function prevPuzzle() {
        currentIdx = (currentIdx - 1 + puzzles.length) % puzzles.length;
        updateBoard();
    }

    const config = {
        draggable: true,
        position: 'start',
        onDrop: (source, target) => {
            const move = game.move({ from: source, to: target, promotion: 'q' });
            if (move === null) return 'snapback';
            checkSolution(source + target);
        },
        onSnapEnd: () => board.position(game.fen()),
        pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
    };
    
    board = Chessboard('board', config);
    
    // Bind click events to squares
    $('#board').on('click', '.square-55d63', function() {
        const square = $(this).attr('data-square');
        onSquareClick(square);
    });

    updateBoard();
    $(window).resize(board.resize);
</script>

</body>
</html>
